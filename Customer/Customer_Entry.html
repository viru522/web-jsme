<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Add Customer - JSME</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="../css/style.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root { --primary: #b21f2d; }
    body { background: #fafafa; margin: 0; font-family: "Roboto", sans-serif; }

    .navbar { background: var(--primary); padding: 0.7rem 1.2rem; }
    .navbar-brand { display: flex; align-items: center; gap: 10px; color: #fff !important; }
    .navbar-brand .logo {
      background: #fff; color: var(--primary); font-weight: 800; font-size: 18px;
      border-radius: 10px; width: 45px; height: 45px; display: flex;
      align-items: center; justify-content: center;
      box-shadow: 0 3px 8px rgba(255, 255, 255, 0.25);
    }
    .navbar-nav .nav-link { color: #fff !important; font-weight: 500; margin-right: 8px; border-radius: 6px; transition: background 0.2s; padding: 8px 12px !important; }
    .navbar-nav .nav-link:hover { background: rgba(255, 255, 255, 0.2); }
    .navbar-nav .nav-link.active { background: #fff; color: var(--primary) !important; font-weight: 600; }

    .card { background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); margin: 30px auto; max-width: 900px; }
    .form-section { background: #fff9f9; border: 1px solid #f9e0e0; border-radius: 10px; padding: 16px; margin-bottom: 18px; }
    .form-section h6 { color: var(--primary); font-weight: 700; font-size: 15px; text-transform: uppercase; margin-bottom: 10px; }
    .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 14px 16px; }
    textarea.form-control { resize: vertical; min-height: 60px; }

    .btn-danger { background: var(--primary); border: none; padding: 10px 20px; font-weight: 600; border-radius: 10px; }
    .btn-danger:hover { opacity: 0.9; }

    .btn-secondary {
      background: #444;
      color: #fff;
      border: none;
      padding: 10px 20px;
      font-weight: 600;
      border-radius: 10px;
    }
    .btn-secondary:hover { opacity: 0.85; }

    .save-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #fff;
      padding: 12px 16px;
      box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.05);
      border-radius: 10px;
      position: sticky;
      bottom: 0;
      gap: 10px;
    }
    @media (max-width: 768px) {
      .save-bar { flex-direction: column; }
      .btn { width: 100%; }
    }
  </style>
</head>

<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <div class="logo">JSME</div>
        <div style="line-height:1;">
          <div style="font-weight:700;color:#fff;">JSM Electricals</div>
        </div>
      </a>
      <button class="navbar-toggler text-white" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu"
        aria-controls="navMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse justify-content-end" id="navMenu">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="../Dashboard/index.html">üè† Dashboard</a></li>
          <li class="nav-item"><a class="nav-link active" href="../Customer/Customer_Entry.html">‚ûï Add Customer</a></li>
          <li class="nav-item"><a class="nav-link" href="../Customer/Customer_List.html">üë• Customers</a></li>
          <li class="nav-item"><a class="nav-link" href="../Billing/Billing_List.html">üßæ Billing</a></li>
          <li class="nav-item"><a class="nav-link" href="../Winding/Data_List.html">‚öôÔ∏è Winding</a></li>
          <li class="nav-item"><a class="nav-link" href="../Winding/Stator_List.html">üåÄ Stator</a></li>
          <li class="nav-item"><a class="nav-link" href="../Inventory/Stock_List.html">üì¶ Stock</a></li>
          <li class="nav-item"><a class="nav-link" href="../Inventory/Purchase_List.html">üõí Purchase</a></li>
          <li class="nav-item"><a class="nav-link" href="../Inventory/Sale_List.html">üíº Sales</a></li>
          <li class="nav-item"><a class="nav-link" href="../Auth/System.html">‚öôÔ∏è Settings</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main>
    <div class="card">
      <div class="card-header">
        <h5 class="m-0 text-primary">üßç‚Äç‚ôÇÔ∏è Add New Customer</h5>
        <p class="text-muted small-muted">Please fill out all required fields (*)</p>
      </div>

      <form id="customerForm">
        <!-- Basic Info -->
        <div class="form-section">
          <h6>Basic Information</h6>
          <div class="form-grid">
            <div>
              <label class="form-label required">Customer Name</label>
              <input id="customerName" name="name" class="form-control" placeholder="Full Name" required>
            </div>
            <div>
              <label>Company</label>
              <input id="company" name="company" class="form-control" placeholder="Company or Organization">
            </div>
            <div>
              <label class="form-label required">Mobile</label>
              <input id="mobile" name="mobile" class="form-control" placeholder="10-digit number" pattern="[0-9]{10}" required>
            </div>
            <div>
              <label>Email</label>
              <input id="email" name="email" class="form-control" type="email" placeholder="example@mail.com">
            </div>
          </div>
        </div>

        <!-- Address Info -->
        <div class="form-section">
          <h6>Address Information</h6>
          <div class="form-grid">
            <div><label>City</label><input id="city" name="city" class="form-control" placeholder="City"></div>
            <div><label>State</label><input id="state" name="state" class="form-control" placeholder="State"></div>
            <div style="grid-column: 1 / -1;">
              <label>Full Address</label>
              <textarea id="address" name="address" class="form-control" placeholder="Street, landmark, area..."></textarea>
            </div>
          </div>
        </div>

        <!-- Save bar -->
        <div class="save-bar">
          <small class="text-muted">‚ö° Data is stored locally in your browser</small>
          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-danger">üíæ Save Customer</button>
            <a href="Customer_List.html" class="btn btn-secondary">üëÅ View Customers</a>
          </div>
        </div>
      </form>
    </div>

    <footer class="app-footer text-center text-muted my-3">¬© 2008 Jai Santoshi Mata Electrical</footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("customerForm");
    const editData = JSON.parse(localStorage.getItem("editCustomer"));

    if (editData) {
      document.getElementById("customerName").value = editData.name;
      document.getElementById("company").value = editData.company;
      document.getElementById("mobile").value = editData.mobile;
      document.getElementById("email").value = editData.email;
      document.getElementById("city").value = editData.city;
      document.getElementById("state").value = editData.state;
      document.getElementById("address").value = editData.address;
      form.querySelector("button[type='submit']").textContent = "‚úèÔ∏è Update Customer";
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const data = {
        id: editData ? editData.id : Date.now(),
        name: document.getElementById("customerName").value.trim(),
        company: document.getElementById("company").value.trim(),
        mobile: document.getElementById("mobile").value.trim(),
        email: document.getElementById("email").value.trim(),
        city: document.getElementById("city").value.trim(),
        state: document.getElementById("state").value.trim(),
        address: document.getElementById("address").value.trim(),
        status: "Active"
      };

      if (!data.name || !data.mobile) return alert("‚ö†Ô∏è Name and Mobile number are required!");

      let customers = JSON.parse(localStorage.getItem("customers")) || [];
      if (editData) {
        const index = customers.findIndex(c => c.id === editData.id);
        if (index !== -1) customers[index] = data;
        localStorage.removeItem("editCustomer");
        alert("‚úÖ Customer updated successfully!");
      } else {
        customers.push(data);
        alert("‚úÖ Customer added successfully!");
      }

      localStorage.setItem("customers", JSON.stringify(customers));
      window.location.href = "Customer_List.html";
    });
  });
  </script>

</body>
</html>
